#set ($layout = "default/www/default/layout/default.vm")
#set ($page_title = $seoPageTitle)

<div class="row">
	<!-- category sidebar-->
	<div class="side-bar span3">
		<span class="section-title sidebar-title">Custom search</span>
		<div class="nav-category search-result-custom">

			
			<button class="search-result-custom-btn" id="search-filter"><i class="icon-search">&nbsp;</i> Filter</button>
		</div>
		
		#parse("../../_include/body-sidebar-recent-products.vm")
		
		#parse("../../_include/body-sidebar-light-cart-view.vm")
		
		<a href="" class="sidebar-banner">
			<img src="${common.themeResourcePrefixPath}/img/ads-banner1.jpg" alt="Ads Banner1">
		</a>
	</div>
	<!-- //category sidebar-->
	
	<!-- category product section -->
	<div class="span9">
		<div class="product-section">
			<span class="section-title category-title">Search Result</span>
			<div class="clear border-btm"></div>
			
			<div class="result-head-bar">
				#if ("$!searchText" == "") 
				<h2 class="result-title">$!pagedListHolder.nrOfElements result(s)</h2>
				#end
				#if ("$!searchText" != "")
				<h2 class="result-title">$!pagedListHolder.nrOfElements result(s) for <strong>"$!searchText"</strong></h2>
				#end
				<form id="search-form" class="search-result-form" method="GET" action="">
					<input type="text" name="text" value="$!searchText" placeholder="$wording.get("fo.search.form_search_label_text")" class="result-search-textbox">
					<button class="result-search-btn"><i class="icon-search">&nbsp;</i></button>
					<input type="hidden" name="pageSize" value="$!pageSize"/>
    				<input type="hidden" name="sortBy" value="$!sortBy"/>
    				<input type="hidden" name="order" value="$!order"/>
					<input type="hidden" id="priceStartParam" name="price.start" value="$!priceStart"/>
					<input type="hidden" id="priceEndParam" name="price.end" value="$!priceEnd"/>
					<input type="hidden" name="categoriesFilter" value="$!categoriesFilter"/>
				</form>
			</div>

			#parse("../../_include/body-search-result-toolbar.vm")
						
			<ul class="stores-grid row list-view">
				#foreach( $searchItem in $pagedListHolder.pageList)
				<li class="item span3">
					<a href="$searchItem.detailsUrl" class="store-image">
						<span>
							<img class="lazy" data-original="${searchItem.carouselImage}" src="/assets/images/placeholder.jpg" alt="${searchItem.name}"/>
							<noscript><img src="${searchItem.carouselImage}"></noscript>
						</span>
					</a>					
					<div class="store-info-wrap">
						<a href="$searchItem.detailsUrl" class="store-name">${searchItem.name}</a>
						<p class="store-short-des hide-as-grid">${searchItem.description}</p>
						<a href="$searchItem.detailsUrl">details</a>
					</div>
				</li>
				#end
			</ul>

			<!-- filter bar  -->
			#parse("../../_include/body-search-result-toolbar.vm")
			<!-- //filter bar -->

		</div>
	</div>
	<!-- //category product section -->
</div>

<script type="text/javascript">
	function startupPage(){
    	$script(['library/jsrender/jsrender.min','library/lazyload/jquery.lazyload.min','page.search-result'], function(){
			$("img.lazy").lazyload({
                threshold : 200
            });
    		$.qalingo.search({
				params: {
					text: "$!searchText",
					sortBy: "$!sortBy",
					order: "$!order",
					price:{
						start : $priceStart,
						end   : $priceEnd,
						min   : 0,
						max   : 500
					},
					pageSize: $pagedListHolder.pageSize,
					page: $pagedListHolder.page
				}
			});
			$.qalingo.filter({
				categoriesFilter: "$!categoriesFilter"
			});
    	});
	}
</script>
<script id="caption" type="text/x-jsrender">
From <strong>{{:priceStart}}$</strong> to <strong> {{:endStart}}$</strong> 
</script>